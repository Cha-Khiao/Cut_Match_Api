{
  "openapi": "3.0.3",
  "info": {
    "title": "Cut Match API (ลุคชัด-ตัดเลย)",
    "version": "1.0.0",
    "description": "เอกสาร API สำหรับแอปพลิเคชัน Cut Match ประกอบด้วยระบบจัดการทรงผม, โปรไฟล์ผู้ใช้, และรายการโปรด สร้างขึ้นบนแพลตฟอร์ม Supabase"
  },
  "servers": [
    {
      "url": "https://vpbsnsjojjpzyptbjjfe.supabase.co"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "JWT Token ของผู้ใช้ที่ได้มาจากการล็อกอิน เพื่อยืนยันตัวตน"
      },
      "apiKeyAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "apikey",
        "description": "Public Key (anon key) ของโปรเจกต์ Supabase สำหรับการเข้าถึงข้อมูลสาธารณะ"
      }
    },
    "schemas": {
      "Hairstyle": {
        "type": "object",
        "description": "ข้อมูลเกี่ยวกับทรงผมแต่ละทรง",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "รหัสเฉพาะของทรงผม (UUID)"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "วันเวลาที่ข้อมูลถูกสร้าง"
          },
          "name": {
            "type": "string",
            "description": "ชื่อทรงผม เช่น ทรงคอมม่า, Two Block"
          },
          "description": {
            "type": "string",
            "description": "คำอธิบายรายละเอียดของทรงผม"
          },
          "image_url": {
            "type": "string",
            "format": "uri",
            "description": "URL ของรูปภาพตัวอย่างทรงผม"
          },
          "ar_asset_url": {
            "type": "string",
            "format": "uri",
            "description": "URL ของไฟล์ AR สำหรับการลองทรงผมแบบเรียลไทม์"
          }
        },
        "required": ["id", "name"]
      },
      "Profile": {
        "type": "object",
        "description": "ข้อมูลโปรไฟล์สาธารณะของผู้ใช้",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "รหัสเฉพาะของผู้ใช้ (ต้องตรงกับ auth.users.id)"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "วันเวลาล่าสุดที่มีการแก้ไขโปรไฟล์"
          },
          "username": {
            "type": "string",
            "description": "ชื่อผู้ใช้ในระบบ (ต้องไม่ซ้ำกัน)"
          },
          "full_name": {
            "type": "string",
            "description": "ชื่อ-นามสกุลจริงของผู้ใช้"
          },
          "avatar_url": {
            "type": "string",
            "format": "uri",
            "description": "URL ของรูปโปรไฟล์"
          }
        },
        "required": ["id"]
      },
      "Favorite": {
        "type": "object",
        "description": "ข้อมูลการกดถูกใจทรงผมของผู้ใช้ ซึ่งเป็นการเชื่อมโยงระหว่างผู้ใช้กับทรงผม",
        "properties": {
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "รหัสของผู้ใช้ที่กดถูกใจ (จากตาราง profiles)"
          },
          "hairstyle_id": {
            "type": "string",
            "format": "uuid",
            "description": "รหัสของทรงผมที่ถูกถูกใจ (จากตาราง hairstyles)"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "วันเวลาที่กดถูกใจ"
          }
        },
        "required": ["user_id", "hairstyle_id"]
      },
      "Error": {
        "type": "object",
        "description": "โครงสร้างข้อมูลเมื่อเกิดข้อผิดพลาดจากฝั่งเซิร์ฟเวอร์",
        "properties": {
          "message": {
            "type": "string",
            "description": "ข้อความอธิบายข้อผิดพลาด"
          },
          "code": {
            "type": "string",
            "description": "โค้ดของข้อผิดพลาด"
          },
          "hint": {
            "type": "string",
            "description": "คำใบ้เพิ่มเติม (ถ้ามี)"
          }
        }
      }
    }
  },
  "paths": {
    "/rest/v1/hairstyles": {
      "get": {
        "summary": "เรียกดูทรงผมทั้งหมด",
        "description": "ดึงข้อมูลทรงผมทั้งหมดที่มีอยู่ในระบบ Endpoint นี้เป็นสาธารณะ ทุกคนสามารถเรียกดูได้",
        "tags": ["Hairstyles (ทรงผม)"],
        "security": [{ "apiKeyAuth": [] }],
        "responses": {
          "200": {
            "description": "ส่งข้อมูลทรงผมทั้งหมดกลับไปเป็น Array",
            "content": {
              "application/json": { "schema": { "type": "array", "items": { "$ref": "#/components/schemas/Hairstyle" } } }
            }
          }
        }
      }
    },
    "/rest/v1/profiles": {
      "get": {
        "summary": "เรียกดูโปรไฟล์ผู้ใช้",
        "description": "ดึงข้อมูลโปรไฟล์ของผู้ใช้ สามารถใช้ Query Parameter เพื่อกรองข้อมูลได้ เช่น `?id=eq.{uuid}` เพื่อค้นหาจาก ID ของผู้ใช้",
        "tags": ["Profiles (โปรไฟล์)"],
        "security": [{ "apiKeyAuth": [], "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "ส่งข้อมูลโปรไฟล์ที่ค้นหาเจอ",
            "content": {
              "application/json": { "schema": { "type": "array", "items": { "$ref": "#/components/schemas/Profile" } } }
            }
          }
        }
      },
      "patch": {
        "summary": "อัปเดตโปรไฟล์ของตัวเอง",
        "description": "อัปเดตข้อมูลโปรไฟล์ (เช่น ชื่อ, รูปโปรไฟล์) ของผู้ใช้ที่ล็อกอินอยู่เท่านั้น โดยต้องระบุ ID ของผู้ใช้ใน Query Parameter (`?id=eq.{uuid}`)",
        "tags": ["Profiles (โปรไฟล์)"],
        "security": [{ "apiKeyAuth": [], "bearerAuth": [] }],
        "requestBody": {
          "description": "ข้อมูลที่ต้องการอัปเดต",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": { "username": { "type": "string" }, "full_name": { "type": "string" }, "avatar_url": { "type": "string", "format": "uri" } }
              }
            }
          }
        },
        "responses": {
          "204": { "description": "อัปเดตข้อมูลสำเร็จ (ไม่มีข้อมูลส่งกลับ)" }
        }
      }
    },
    "/rest/v1/favorites": {
      "get": {
        "summary": "เรียกดูรายการโปรดของฉัน",
        "description": "ดึงข้อมูลทรงผมที่ผู้ใช้ที่ล็อกอินอยู่ได้กดถูกใจไว้ จำเป็นต้องกรองข้อมูลด้วย `user_id` ของตนเอง (เช่น `?select=*&user_id=eq.{uuid}`)",
        "tags": ["Favorites (รายการโปรด)"],
        "security": [{ "apiKeyAuth": [], "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "ส่งข้อมูลรายการโปรดทั้งหมดของผู้ใช้กลับไป",
            "content": {
              "application/json": { "schema": { "type": "array", "items": { "$ref": "#/components/schemas/Favorite" } } }
            }
          }
        }
      },
      "post": {
        "summary": "เพิ่มรายการโปรดใหม่",
        "description": "บันทึกทรงผมที่เลือกเป็นรายการโปรดของผู้ใช้ที่ล็อกอินอยู่",
        "tags": ["Favorites (รายการโปรด)"],
        "security": [{ "apiKeyAuth": [], "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "description": "ระบุ user_id และ hairstyle_id ที่ต้องการเพิ่ม",
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/Favorite" } }
          }
        },
        "responses": {
          "201": { "description": "สร้างรายการโปรดสำเร็จ" }
        }
      },
      "delete": {
        "summary": "ลบรายการโปรด",
        "description": "ลบทรงผมออกจากรายการโปรดของผู้ใช้ที่ล็อกอินอยู่ โดยต้องระบุ `user_id` และ `hairstyle_id` ที่ต้องการลบใน Query Parameter",
        "tags": ["Favorites (รายการโปรด)"],
        "security": [{ "apiKeyAuth": [], "bearerAuth": [] }],
        "responses": {
          "204": { "description": "ลบรายการโปรดสำเร็จ (ไม่มีข้อมูลส่งกลับ)" }
        }
      }
    }
  }
}